{
  "task_id": "P4.T081",
  "created_at": "2025-09-14T19:41:47.149713Z",
  "task": {
    "id": "P4.T081",
    "feature_id": "F034",
    "title": "Design Collaborative Session",
    "description": "Design task for Collaborative Session",
    "boundaries": {
      "expected_complexity": {
        "value": "1 design doc, ~800-1200 lines",
        "breakdown": "Architecture (400), API spec (300), Data model (200), Diagrams (300)"
      },
      "definition_of_done": {
        "criteria": [
          "Architecture documented with Mermaid diagrams",
          "API endpoints specified in OpenAPI 3.0 format",
          "Data models defined with JSON Schema",
          "Integration points identified and documented",
          "Security threat model completed",
          "Performance requirements specified",
          "Testing strategy defined"
        ],
        "stop_when": "Design approved by architect; do NOT start implementation"
      },
      "scope": {
        "includes": [
          "docs/design/f034-design.md",
          "docs/api/f034-openapi.yaml",
          "docs/schemas/f034-schema.json"
        ],
        "excludes": [
          "implementation code",
          "tests",
          "deployment configs"
        ],
        "restrictions": "Must follow company design template"
      }
    },
    "execution_guidance": {
      "logging": {
        "format": "JSON Lines (JSONL)",
        "required_fields": [
          "timestamp",
          "task_id",
          "step",
          "status",
          "message"
        ],
        "optional_fields": [
          "percent",
          "data",
          "checkpoint"
        ],
        "status_values": [
          "start",
          "progress",
          "done",
          "error",
          "checkpoint"
        ]
      },
      "checkpoints": [
        {
          "id": "cp1",
          "at_percent": 25,
          "description": "Architecture draft complete"
        },
        {
          "id": "cp2",
          "at_percent": 50,
          "description": "API specification complete"
        },
        {
          "id": "cp3",
          "at_percent": 75,
          "description": "Data models and diagrams complete"
        },
        {
          "id": "cp4",
          "at_percent": 100,
          "description": "Review and approval"
        }
      ],
      "monitoring": {
        "metrics_to_track": [],
        "alerts": []
      }
    },
    "resource_requirements": {
      "estimated": {
        "cpu_cores": 1,
        "memory_mb": 512,
        "disk_io_mbps": 10
      },
      "peak": {
        "cpu_cores": 2,
        "memory_mb": 1024,
        "disk_io_mbps": 50,
        "during": "compilation or testing"
      },
      "worker_capabilities_required": [
        "documentation",
        "architecture",
        "api_design"
      ]
    },
    "scheduling_hints": {
      "priority": "medium",
      "preemptible": true,
      "retry_on_failure": true,
      "max_retries": 3,
      "checkpoint_capable": true
    },
    "duration": {
      "optimistic": 4,
      "mostLikely": 8,
      "pessimistic": 16
    },
    "shared_resources": {
      "exclusive_locks": [],
      "shared_limited": [],
      "creates": [],
      "modifies": []
    },
    "acceptance_checks": [
      {
        "type": "automated",
        "description": "Read\u2011only viewing with smooth updates under typical terminal sizes.",
        "script": "test_p4.t081.sh"
      },
      {
        "type": "automated",
        "description": "Secure token\u2011based auth with expiry; control handoff flow.",
        "script": "test_p4.t081.sh"
      },
      {
        "type": "automated",
        "description": "Redaction of configured secrets in frames.",
        "script": "test_p4.t081.sh"
      },
      {
        "type": "manual",
        "description": "Session server + transport",
        "script": null
      },
      {
        "type": "manual",
        "description": "Presenter/observer UI + handoff",
        "script": null
      }
    ],
    "evidence": [
      {
        "type": "plan",
        "source": "docs/ideas/collaborative-session.md",
        "excerpt": "Share a read\u2011only live TUI session over the network. A presenter can invite observers to follow along; optionally hand control with a key press. Perfect for incident reviews, pairing, and demos\u2014withou",
        "confidence": 1.0,
        "rationale": "Primary feature specification"
      }
    ],
    "implementation_spec": {
      "design_sections": [
        "Executive Summary",
        "System Architecture",
        "API Specification",
        "Data Models",
        "Security Model",
        "Performance Requirements",
        "Testing Strategy",
        "Deployment Plan"
      ],
      "deliverables": [
        "Architecture document (Markdown + Mermaid)",
        "OpenAPI 3.0 specification",
        "JSON Schema definitions",
        "Security threat model",
        "Performance benchmarks"
      ],
      "technical_approach": [
        "Architecture:",
        "Session host multiplexes TUI output and input events over a secure transport.",
        "Observers receive frame deltas; optional control token to accept input.",
        "Transport & security:",
        "Default: SSH port forwarding or WebSocket over TLS to a small embedded server.",
        "Auth: one\u2011time session token with expiry; optional mTLS.",
        "Permissions: read\u2011only by default; control handoff requires explicit approval.",
        "TUI integration:",
        "Presenter mode indicator; participant list; handoff prompt; control timeout.",
        "Frame capture with minimal diff encoding (lines changed per tick) to keep CPU low.",
        "Observability:",
        "Session logs: joins/leaves, handoffs, duration.",
        "Metrics: active sessions, participants, bandwidth.",
        "Safety: redact sensitive values in frames (configurable patterns) before broadcast."
      ],
      "user_stories": [
        "I can start a collaborative session and share a link/token for read\u2011only viewing.",
        "I can hand control to a participant temporarily and revoke it easily."
      ]
    }
  },
  "dependencies": [],
  "instructions": {
    "on_complete": "Move this file to finished-tasks/P4.T081.json",
    "on_failure": "Move this file to failed-tasks/P4.T081.json",
    "on_help_needed": "Move to help-me/P4.T081.json",
    "note": "READ THE FULL TASK SPECIFICATION! All details are in the task field.",
    "resource_locks": {
      "exclusive_locks": [],
      "shared_limited": [],
      "creates": [],
      "modifies": []
    }
  }
}