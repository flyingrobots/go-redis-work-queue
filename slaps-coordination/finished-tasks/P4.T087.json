{
  "task_id": "P4.T087",
  "created_at": "2025-09-14T19:41:47.151490Z",
  "task": {
    "id": "P4.T087",
    "feature_id": "F037",
    "title": "Design Right Click Context Menus",
    "description": "Design task for Right Click Context Menus",
    "boundaries": {
      "expected_complexity": {
        "value": "1 design doc, ~800-1200 lines",
        "breakdown": "Architecture (400), API spec (300), Data model (200), Diagrams (300)"
      },
      "definition_of_done": {
        "criteria": [
          "Architecture documented with Mermaid diagrams",
          "API endpoints specified in OpenAPI 3.0 format",
          "Data models defined with JSON Schema",
          "Integration points identified and documented",
          "Security threat model completed",
          "Performance requirements specified",
          "Testing strategy defined"
        ],
        "stop_when": "Design approved by architect; do NOT start implementation"
      },
      "scope": {
        "includes": [
          "docs/design/f037-design.md",
          "docs/api/f037-openapi.yaml",
          "docs/schemas/f037-schema.json"
        ],
        "excludes": [
          "implementation code",
          "tests",
          "deployment configs"
        ],
        "restrictions": "Must follow company design template"
      }
    },
    "execution_guidance": {
      "logging": {
        "format": "JSON Lines (JSONL)",
        "required_fields": [
          "timestamp",
          "task_id",
          "step",
          "status",
          "message"
        ],
        "optional_fields": [
          "percent",
          "data",
          "checkpoint"
        ],
        "status_values": [
          "start",
          "progress",
          "done",
          "error",
          "checkpoint"
        ]
      },
      "checkpoints": [
        {
          "id": "cp1",
          "at_percent": 25,
          "description": "Architecture draft complete"
        },
        {
          "id": "cp2",
          "at_percent": 50,
          "description": "API specification complete"
        },
        {
          "id": "cp3",
          "at_percent": 75,
          "description": "Data models and diagrams complete"
        },
        {
          "id": "cp4",
          "at_percent": 100,
          "description": "Review and approval"
        }
      ],
      "monitoring": {
        "metrics_to_track": [],
        "alerts": []
      }
    },
    "resource_requirements": {
      "estimated": {
        "cpu_cores": 1,
        "memory_mb": 512,
        "disk_io_mbps": 10
      },
      "peak": {
        "cpu_cores": 2,
        "memory_mb": 1024,
        "disk_io_mbps": 50,
        "during": "compilation or testing"
      },
      "worker_capabilities_required": [
        "documentation",
        "architecture",
        "api_design"
      ]
    },
    "scheduling_hints": {
      "priority": "medium",
      "preemptible": true,
      "retry_on_failure": true,
      "max_retries": 3,
      "checkpoint_capable": true
    },
    "duration": {
      "optimistic": 4,
      "mostLikely": 8,
      "pessimistic": 16
    },
    "shared_resources": {
      "exclusive_locks": [],
      "shared_limited": [],
      "creates": [],
      "modifies": []
    },
    "acceptance_checks": [
      {
        "type": "automated",
        "description": "Precise hitboxes with `bubblezone` on rows/tabs.",
        "script": "test_p4.t087.sh"
      },
      {
        "type": "automated",
        "description": "Context menu overlays with keyboard + mouse interaction.",
        "script": "test_p4.t087.sh"
      },
      {
        "type": "automated",
        "description": "Destructive actions gated with explicit confirmation.",
        "script": "test_p4.t087.sh"
      },
      {
        "type": "manual",
        "description": "Integrate `bubblezone` and register zones",
        "script": null
      },
      {
        "type": "manual",
        "description": "Build menu overlay component",
        "script": null
      }
    ],
    "evidence": [
      {
        "type": "plan",
        "source": "docs/ideas/right-click-context-menus.md",
        "excerpt": "Add contextual menus on right\u2011click (and `m`) across the TUI to expose actions where users are looking: peek, requeue, purge (confirmed), copy payload/key, open trace, export sample. Menus appear adja",
        "confidence": 1.0,
        "rationale": "Primary feature specification"
      }
    ],
    "implementation_spec": {
      "design_sections": [
        "Executive Summary",
        "System Architecture",
        "API Specification",
        "Data Models",
        "Security Model",
        "Performance Requirements",
        "Testing Strategy",
        "Deployment Plan"
      ],
      "deliverables": [
        "Architecture document (Markdown + Mermaid)",
        "OpenAPI 3.0 specification",
        "JSON Schema definitions",
        "Security threat model",
        "Performance benchmarks"
      ],
      "technical_approach": [
        "Hitboxes: integrate `bubblezone` to register zones for tabs, table rows, charts, and info regions.",
        "Menu widget: lightweight overlay with items, accelerators, and disabled states; auto\u2011positions within viewport.",
        "Action registry: map context (e.g., queue row, DLQ item) to available actions with capability checks.",
        "Safety: destructive items require confirm modal; show exact scope (e.g., \u201cPurge DLQ dead_letter (123 items)\u201d).",
        "Keyboard parity: `m` opens context menu for the focused item; arrow/enter to select.",
        "Extensibility: plug new actions via registry to avoid scattering logic."
      ],
      "user_stories": [
        "I can right\u2011click a queue row and choose Peek or Enqueue.",
        "I can right\u2011click DLQ items and Requeue/Purge with confirmation."
      ]
    }
  },
  "dependencies": [],
  "instructions": {
    "on_complete": "Move this file to finished-tasks/P4.T087.json",
    "on_failure": "Move this file to failed-tasks/P4.T087.json",
    "on_help_needed": "Move to help-me/P4.T087.json",
    "note": "READ THE FULL TASK SPECIFICATION! All details are in the task field.",
    "resource_locks": {
      "exclusive_locks": [],
      "shared_limited": [],
      "creates": [],
      "modifies": []
    }
  }
}