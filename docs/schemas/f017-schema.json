{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://go-redis-work-queue.example.com/schemas/f017-job-genealogy-navigator.json",
  "title": "Job Genealogy Navigator Schema Definitions",
  "description": "JSON Schema definitions for job genealogy tracking, tree visualization, and relationship analysis",
  "definitions": {
    "JobRelationship": {
      "type": "object",
      "title": "Job Relationship",
      "description": "Represents a relationship between two jobs in the genealogy tree",
      "properties": {
        "parent_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Parent job identifier"
        },
        "child_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Child job identifier"
        },
        "type": {
          "type": "string",
          "enum": ["retry", "spawn", "fork", "callback", "compensation", "continuation", "batch_member", "dependency"],
          "description": "Type of relationship between jobs"
        },
        "spawn_reason": {
          "type": "string",
          "maxLength": 256,
          "description": "Reason for creating this relationship"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When the relationship was created"
        },
        "generation": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Generation level of the child job"
        },
        "depth": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Depth from the root job"
        },
        "payload_similarity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Similarity score between parent and child payloads"
        },
        "processing_context": {
          "type": "object",
          "patternProperties": {
            "^[a-z_][a-z0-9_]*$": {
              "type": "string"
            }
          },
          "maxProperties": 50,
          "description": "Additional context about the relationship"
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Relationship creation timestamp"
        },
        "ttl": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time-to-live for relationship data"
        }
      },
      "required": ["parent_id", "child_id", "type", "timestamp"],
      "additionalProperties": false
    },
    "JobGenealogy": {
      "type": "object",
      "title": "Job Genealogy Tree",
      "description": "Complete family tree structure for a job and its relationships",
      "properties": {
        "root_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Root job ID of the genealogy tree"
        },
        "query_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Job ID that was queried to build this tree"
        },
        "tree_scope": {
          "type": "string",
          "enum": ["full", "ancestors", "descendants", "blame", "impact"],
          "description": "Scope of the genealogy tree"
        },
        "nodes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/GenealogyNode"
          },
          "maxItems": 10000,
          "description": "All nodes in the genealogy tree"
        },
        "edges": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/GenealogyEdge"
          },
          "maxItems": 50000,
          "description": "All edges (relationships) in the tree"
        },
        "generations": {
          "type": "object",
          "patternProperties": {
            "^\\d+$": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^job-[a-zA-Z0-9-]+$"
              }
            }
          },
          "description": "Jobs grouped by generation level"
        },
        "total_nodes": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10000,
          "description": "Total number of nodes in the tree"
        },
        "max_depth": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Maximum depth of the tree"
        },
        "max_breadth": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Maximum breadth at any level"
        },
        "success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Overall success rate of jobs in tree"
        },
        "tree_span": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time span from oldest to newest job"
        },
        "oldest_job": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of oldest job in tree"
        },
        "newest_job": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of newest job in tree"
        },
        "critical_path": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "description": "Critical path through the genealogy"
        },
        "failure_chain": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "description": "Chain of failed jobs"
        },
        "impact_radius": {
          "$ref": "#/definitions/ImpactAnalysis",
          "description": "Impact analysis for the queried job"
        },
        "computed_at": {
          "type": "string",
          "format": "date-time",
          "description": "When this genealogy was computed"
        },
        "cache_key": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9-_:]+$",
          "description": "Cache key for this genealogy"
        },
        "ttl": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time-to-live for cached genealogy"
        }
      },
      "required": ["root_id", "query_job_id", "tree_scope", "nodes", "edges"],
      "additionalProperties": false
    },
    "GenealogyNode": {
      "type": "object",
      "title": "Genealogy Tree Node",
      "description": "Represents a single job node in the genealogy tree",
      "properties": {
        "job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Unique job identifier"
        },
        "job_type": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "maxLength": 128,
          "description": "Type of job"
        },
        "status": {
          "type": "string",
          "enum": ["success", "failed", "processing", "queued", "cancelled"],
          "description": "Current job status"
        },
        "generation": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Generation level in the tree (0 = root)"
        },
        "parents": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 100,
          "description": "Parent job IDs"
        },
        "children": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 1000,
          "description": "Child job IDs"
        },
        "siblings": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 1000,
          "description": "Sibling job IDs"
        },
        "display_name": {
          "type": "string",
          "maxLength": 256,
          "description": "Human-readable name for display"
        },
        "status_emoji": {
          "type": "string",
          "pattern": "^[\\u{1F600}-\\u{1F64F}\\u{1F300}-\\u{1F5FF}\\u{1F680}-\\u{1F6FF}\\u{1F1E0}-\\u{1F1FF}\\u{2600}-\\u{26FF}\\u{2700}-\\u{27BF}]$",
          "description": "Emoji representation of status"
        },
        "duration": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Job processing duration"
        },
        "tree_x": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10000,
          "description": "X coordinate for tree layout"
        },
        "tree_y": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10000,
          "description": "Y coordinate for tree layout"
        },
        "collapsed": {
          "type": "boolean",
          "default": false,
          "description": "Whether node is collapsed in visualization"
        },
        "highlighted": {
          "type": "boolean",
          "default": false,
          "description": "Whether node is highlighted"
        },
        "payload_hash": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{64}$",
          "description": "SHA-256 hash of job payload"
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Job creation timestamp"
        },
        "started_at": {
          "type": "string",
          "format": "date-time",
          "description": "Job start timestamp"
        },
        "completed_at": {
          "type": "string",
          "format": "date-time",
          "description": "Job completion timestamp"
        }
      },
      "required": ["job_id", "job_type", "status", "generation"],
      "additionalProperties": false
    },
    "GenealogyEdge": {
      "type": "object",
      "title": "Genealogy Tree Edge",
      "description": "Represents a relationship edge between two nodes in the genealogy tree",
      "properties": {
        "from_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Source job ID (parent)"
        },
        "to_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Target job ID (child)"
        },
        "relationship": {
          "$ref": "#/definitions/JobRelationship",
          "description": "Relationship details"
        },
        "line_style": {
          "type": "string",
          "enum": ["solid", "dashed", "dotted", "bold"],
          "default": "solid",
          "description": "Visual line style"
        },
        "color": {
          "type": "string",
          "pattern": "^#[0-9a-fA-F]{6}$|^[a-z]+$",
          "description": "Edge color for visualization"
        },
        "thickness": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 1,
          "description": "Line thickness"
        },
        "label": {
          "type": "string",
          "maxLength": 64,
          "description": "Optional edge label"
        },
        "weight": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Edge weight for layout algorithms"
        }
      },
      "required": ["from_job_id", "to_job_id", "relationship"],
      "additionalProperties": false
    },
    "BlameAnalysis": {
      "type": "object",
      "title": "Blame Analysis Result",
      "description": "Result of tracing a failed job back to its root cause",
      "properties": {
        "source_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Job ID that was analyzed for blame"
        },
        "blame_path": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "minItems": 1,
          "maxItems": 1000,
          "description": "Path from failed job to root cause"
        },
        "root_cause_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Job ID identified as root cause"
        },
        "root_cause_reason": {
          "type": "string",
          "maxLength": 512,
          "description": "Reason for root cause identification"
        },
        "failure_cascade_count": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100000,
          "description": "Number of jobs affected by cascade failure"
        },
        "analysis_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence level of blame analysis"
        },
        "contributing_factors": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 256
          },
          "maxItems": 20,
          "description": "Additional factors that contributed to failure"
        },
        "recommendations": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 512
          },
          "maxItems": 10,
          "description": "Recommended actions to prevent recurrence"
        },
        "similar_incidents": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 100,
          "description": "Job IDs of similar historical incidents"
        },
        "computed_at": {
          "type": "string",
          "format": "date-time",
          "description": "When this analysis was performed"
        },
        "analysis_duration": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time taken to perform the analysis"
        }
      },
      "required": ["source_job_id", "blame_path", "root_cause_job_id", "analysis_confidence"],
      "additionalProperties": false
    },
    "ImpactAnalysis": {
      "type": "object",
      "title": "Impact Analysis Result",
      "description": "Analysis of the impact radius and effects of a job",
      "properties": {
        "source_job_id": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Job ID that was analyzed for impact"
        },
        "direct_children": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100000,
          "description": "Number of direct child jobs"
        },
        "total_descendants": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000000,
          "description": "Total number of descendant jobs"
        },
        "affected_jobs": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 100000,
          "description": "All job IDs affected by this job"
        },
        "successful_jobs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of successful descendant jobs"
        },
        "failed_jobs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of failed descendant jobs"
        },
        "processing_jobs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of currently processing jobs"
        },
        "queued_jobs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of queued descendant jobs"
        },
        "total_processing_time": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Total processing time of all descendants"
        },
        "estimated_cost": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000000,
          "description": "Estimated cost of all descendant processing"
        },
        "resource_usage": {
          "$ref": "#/definitions/ResourceUsage",
          "description": "Resource usage metrics"
        },
        "impact_time_span": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time span of impact"
        },
        "cascade_delay": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Delay before cascade effects"
        },
        "recovery_estimate": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Estimated time to recovery"
        },
        "similar_incidents": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 100,
          "description": "Similar historical incidents"
        },
        "recurrence_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Likelihood of recurrence"
        },
        "computed_at": {
          "type": "string",
          "format": "date-time",
          "description": "When this analysis was performed"
        }
      },
      "required": ["source_job_id", "direct_children", "total_descendants"],
      "additionalProperties": false
    },
    "ResourceUsage": {
      "type": "object",
      "title": "Resource Usage Metrics",
      "description": "Resource consumption metrics for job processing",
      "properties": {
        "cpu_seconds": {
          "type": "number",
          "minimum": 0,
          "maximum": 100000000,
          "description": "Total CPU seconds consumed"
        },
        "memory_mb_hours": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000000000,
          "description": "Memory usage in MB-hours"
        },
        "network_mb": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000000,
          "description": "Network data transferred in MB"
        },
        "storage_io_ops": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000000000,
          "description": "Storage I/O operations"
        },
        "disk_mb": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000000,
          "description": "Disk space used in MB"
        }
      },
      "additionalProperties": false
    },
    "GenealogyPattern": {
      "type": "object",
      "title": "Genealogy Pattern",
      "description": "Detected pattern in job genealogy structures",
      "properties": {
        "pattern_id": {
          "type": "string",
          "pattern": "^pattern-[a-zA-Z0-9-]+$",
          "description": "Unique pattern identifier"
        },
        "pattern_type": {
          "type": "string",
          "enum": ["retry_chain", "failure_fan", "deep_nesting", "wide_spread", "cycle", "anomaly"],
          "description": "Type of detected pattern"
        },
        "frequency": {
          "type": "integer",
          "minimum": 1,
          "maximum": 1000000,
          "description": "Number of times pattern was observed"
        },
        "node_pattern": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/NodeTemplate"
          },
          "maxItems": 100,
          "description": "Node pattern template"
        },
        "edge_pattern": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EdgeTemplate"
          },
          "maxItems": 200,
          "description": "Edge pattern template"
        },
        "structure_hash": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{64}$",
          "description": "SHA-256 hash of pattern structure"
        },
        "first_seen": {
          "type": "string",
          "format": "date-time",
          "description": "When pattern was first detected"
        },
        "last_seen": {
          "type": "string",
          "format": "date-time",
          "description": "When pattern was last observed"
        },
        "occurrences": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 10000,
          "description": "Job IDs where pattern was found"
        },
        "success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Success rate for this pattern"
        },
        "avg_duration": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Average duration for pattern execution"
        },
        "failure_reasons": {
          "type": "object",
          "patternProperties": {
            "^[a-z_][a-z0-9_]*$": {
              "type": "integer",
              "minimum": 0
            }
          },
          "maxProperties": 50,
          "description": "Failure reasons and their frequencies"
        },
        "recommendations": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 512
          },
          "maxItems": 10,
          "description": "Recommendations for pattern optimization"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in pattern detection"
        },
        "severity": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"],
          "description": "Severity level of the pattern"
        }
      },
      "required": ["pattern_id", "pattern_type", "frequency", "structure_hash"],
      "additionalProperties": false
    },
    "NodeTemplate": {
      "type": "object",
      "title": "Node Template",
      "description": "Template for matching nodes in pattern detection",
      "properties": {
        "job_type_pattern": {
          "type": "string",
          "maxLength": 256,
          "description": "Regular expression for job type matching"
        },
        "status_pattern": {
          "type": "string",
          "pattern": "^(success|failed|processing|queued|cancelled|\\*)$",
          "description": "Status pattern for matching"
        },
        "position_pattern": {
          "type": "string",
          "enum": ["root", "leaf", "middle", "any"],
          "description": "Position in tree"
        },
        "generation_range": {
          "type": "object",
          "properties": {
            "min": {
              "type": "integer",
              "minimum": 0
            },
            "max": {
              "type": "integer",
              "minimum": 0
            }
          },
          "additionalProperties": false,
          "description": "Generation range for matching"
        },
        "constraints": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 128
          },
          "maxItems": 20,
          "description": "Additional constraints for matching"
        }
      },
      "additionalProperties": false
    },
    "EdgeTemplate": {
      "type": "object",
      "title": "Edge Template",
      "description": "Template for matching edges in pattern detection",
      "properties": {
        "relationship_type": {
          "type": "string",
          "enum": ["retry", "spawn", "fork", "callback", "compensation", "continuation", "batch_member", "dependency", "*"],
          "description": "Required relationship type"
        },
        "direction": {
          "type": "string",
          "enum": ["parent_to_child", "child_to_parent", "bidirectional"],
          "description": "Direction of relationship"
        },
        "required": {
          "type": "boolean",
          "default": true,
          "description": "Whether this edge is required for pattern match"
        },
        "multiplicity": {
          "type": "string",
          "enum": ["one", "many", "optional"],
          "description": "Edge multiplicity"
        },
        "weight_range": {
          "type": "object",
          "properties": {
            "min": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "max": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          },
          "additionalProperties": false,
          "description": "Weight range for edge matching"
        }
      },
      "required": ["relationship_type"],
      "additionalProperties": false
    },
    "SearchResult": {
      "type": "object",
      "title": "Search Result",
      "description": "Result from genealogy search operations",
      "properties": {
        "id": {
          "type": "string",
          "description": "Result identifier"
        },
        "type": {
          "type": "string",
          "enum": ["job", "relationship", "pattern", "tree"],
          "description": "Type of search result"
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Relevance score"
        },
        "title": {
          "type": "string",
          "maxLength": 256,
          "description": "Result title"
        },
        "description": {
          "type": "string",
          "maxLength": 1024,
          "description": "Result description"
        },
        "metadata": {
          "type": "object",
          "maxProperties": 50,
          "description": "Additional result metadata"
        },
        "highlight": {
          "type": "object",
          "patternProperties": {
            "^[a-z_][a-z0-9_]*$": {
              "type": "array",
              "items": {
                "type": "string",
                "maxLength": 256
              },
              "maxItems": 10
            }
          },
          "maxProperties": 20,
          "description": "Highlighted matching text"
        },
        "matched_at": {
          "type": "string",
          "format": "date-time",
          "description": "When the match was found"
        }
      },
      "required": ["id", "type", "score"],
      "additionalProperties": false
    },
    "GenealogyStatistics": {
      "type": "object",
      "title": "Genealogy Statistics",
      "description": "System-wide statistics about job genealogies",
      "properties": {
        "time_range": {
          "type": "string",
          "pattern": "^\\d+(\\.\\d+)?[smhd]$",
          "description": "Time range for statistics"
        },
        "total_jobs": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of jobs tracked"
        },
        "total_relationships": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of relationships"
        },
        "avg_tree_size": {
          "type": "number",
          "minimum": 0,
          "description": "Average genealogy tree size"
        },
        "max_tree_size": {
          "type": "integer",
          "minimum": 0,
          "description": "Largest genealogy tree size"
        },
        "avg_tree_depth": {
          "type": "number",
          "minimum": 0,
          "description": "Average tree depth"
        },
        "max_tree_depth": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum tree depth observed"
        },
        "relationship_type_distribution": {
          "type": "object",
          "patternProperties": {
            "^(retry|spawn|fork|callback|compensation|continuation|batch_member|dependency)$": {
              "type": "integer",
              "minimum": 0
            }
          },
          "description": "Distribution of relationship types"
        },
        "success_rate_by_generation": {
          "type": "object",
          "patternProperties": {
            "^\\d+$": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          },
          "description": "Success rates by generation level"
        },
        "top_job_types": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "job_type": {
                "type": "string"
              },
              "count": {
                "type": "integer",
                "minimum": 0
              },
              "success_rate": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              }
            },
            "required": ["job_type", "count"],
            "additionalProperties": false
          },
          "maxItems": 100,
          "description": "Most frequent job types"
        },
        "performance_metrics": {
          "type": "object",
          "properties": {
            "avg_tree_build_time": {
              "type": "string",
              "pattern": "^\\d+(\\.\\d+)?[smhd]$",
              "description": "Average tree build time"
            },
            "cache_hit_rate": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Cache hit rate"
            },
            "queries_per_second": {
              "type": "number",
              "minimum": 0,
              "description": "Query rate"
            },
            "avg_response_time": {
              "type": "string",
              "pattern": "^\\d+(\\.\\d+)?[smhd]$",
              "description": "Average API response time"
            }
          },
          "additionalProperties": false,
          "description": "Performance metrics"
        },
        "computed_at": {
          "type": "string",
          "format": "date-time",
          "description": "When statistics were computed"
        }
      },
      "required": ["time_range", "total_jobs", "total_relationships"],
      "additionalProperties": false
    },
    "LayoutConfig": {
      "type": "object",
      "title": "Tree Layout Configuration",
      "description": "Configuration for tree layout algorithms",
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["top_down", "timeline", "radial", "compact", "force_directed"],
          "default": "top_down",
          "description": "Layout algorithm to use"
        },
        "node_spacing": {
          "type": "object",
          "properties": {
            "horizontal": {
              "type": "integer",
              "minimum": 1,
              "maximum": 50,
              "default": 4
            },
            "vertical": {
              "type": "integer",
              "minimum": 1,
              "maximum": 20,
              "default": 2
            }
          },
          "additionalProperties": false,
          "description": "Spacing between nodes"
        },
        "viewport": {
          "type": "object",
          "properties": {
            "width": {
              "type": "integer",
              "minimum": 10,
              "maximum": 1000,
              "default": 80
            },
            "height": {
              "type": "integer",
              "minimum": 5,
              "maximum": 100,
              "default": 24
            }
          },
          "additionalProperties": false,
          "description": "Viewport dimensions"
        },
        "collapse_threshold": {
          "type": "integer",
          "minimum": 1,
          "maximum": 1000,
          "default": 100,
          "description": "Auto-collapse trees larger than this"
        },
        "max_display_depth": {
          "type": "integer",
          "minimum": 1,
          "maximum": 50,
          "default": 10,
          "description": "Maximum depth to display"
        }
      },
      "additionalProperties": false
    },
    "VisualizationTheme": {
      "type": "object",
      "title": "Visualization Theme",
      "description": "Theme configuration for tree visualization",
      "properties": {
        "box_chars": {
          "type": "object",
          "properties": {
            "horizontal": {
              "type": "string",
              "maxLength": 1,
              "default": "─"
            },
            "vertical": {
              "type": "string",
              "maxLength": 1,
              "default": "│"
            },
            "top_left": {
              "type": "string",
              "maxLength": 1,
              "default": "┌"
            },
            "top_right": {
              "type": "string",
              "maxLength": 1,
              "default": "┐"
            },
            "bottom_left": {
              "type": "string",
              "maxLength": 1,
              "default": "└"
            },
            "bottom_right": {
              "type": "string",
              "maxLength": 1,
              "default": "┘"
            },
            "cross": {
              "type": "string",
              "maxLength": 1,
              "default": "┼"
            },
            "tee_down": {
              "type": "string",
              "maxLength": 1,
              "default": "┬"
            },
            "tee_up": {
              "type": "string",
              "maxLength": 1,
              "default": "┴"
            },
            "tee_left": {
              "type": "string",
              "maxLength": 1,
              "default": "┤"
            },
            "tee_right": {
              "type": "string",
              "maxLength": 1,
              "default": "├"
            }
          },
          "additionalProperties": false,
          "description": "Box-drawing characters"
        },
        "status_emojis": {
          "type": "object",
          "properties": {
            "success": {
              "type": "string",
              "maxLength": 2,
              "default": "✅"
            },
            "failed": {
              "type": "string",
              "maxLength": 2,
              "default": "❌"
            },
            "processing": {
              "type": "string",
              "maxLength": 2,
              "default": "🔄"
            },
            "queued": {
              "type": "string",
              "maxLength": 2,
              "default": "⏸️"
            },
            "cancelled": {
              "type": "string",
              "maxLength": 2,
              "default": "⏹️"
            }
          },
          "additionalProperties": false,
          "description": "Status emoji mappings"
        },
        "colors": {
          "type": "object",
          "properties": {
            "success": {
              "type": "string",
              "enum": ["green", "blue", "cyan"],
              "default": "green"
            },
            "failed": {
              "type": "string",
              "enum": ["red", "magenta"],
              "default": "red"
            },
            "processing": {
              "type": "string",
              "enum": ["yellow", "orange"],
              "default": "yellow"
            },
            "queued": {
              "type": "string",
              "enum": ["gray", "white"],
              "default": "gray"
            },
            "highlight": {
              "type": "string",
              "enum": ["bright_white", "bright_yellow"],
              "default": "bright_white"
            }
          },
          "additionalProperties": false,
          "description": "Color scheme"
        }
      },
      "additionalProperties": false
    },
    "NavigationState": {
      "type": "object",
      "title": "Navigation State",
      "description": "Current state of genealogy navigation",
      "properties": {
        "current_job": {
          "type": "string",
          "pattern": "^job-[a-zA-Z0-9-]+$",
          "description": "Currently focused job ID"
        },
        "view_mode": {
          "type": "string",
          "enum": ["full", "ancestors", "descendants", "blame", "impact"],
          "default": "full",
          "description": "Current view mode"
        },
        "layout_mode": {
          "type": "string",
          "enum": ["top_down", "timeline", "radial", "compact"],
          "default": "top_down",
          "description": "Current layout mode"
        },
        "expanded_nodes": {
          "type": "object",
          "patternProperties": {
            "^job-[a-zA-Z0-9-]+$": {
              "type": "boolean"
            }
          },
          "maxProperties": 10000,
          "description": "Node expansion state"
        },
        "focus_path": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^job-[a-zA-Z0-9-]+$"
          },
          "maxItems": 1000,
          "description": "Path to current focus"
        },
        "filter_state": {
          "$ref": "#/definitions/FilterState",
          "description": "Current filter settings"
        },
        "scroll_position": {
          "type": "object",
          "properties": {
            "x": {
              "type": "integer"
            },
            "y": {
              "type": "integer"
            }
          },
          "additionalProperties": false,
          "description": "Current scroll position"
        }
      },
      "required": ["current_job"],
      "additionalProperties": false
    },
    "FilterState": {
      "type": "object",
      "title": "Filter State",
      "description": "Current filter settings for genealogy display",
      "properties": {
        "show_success": {
          "type": "boolean",
          "default": true,
          "description": "Show successful jobs"
        },
        "show_failed": {
          "type": "boolean",
          "default": true,
          "description": "Show failed jobs"
        },
        "show_processing": {
          "type": "boolean",
          "default": true,
          "description": "Show processing jobs"
        },
        "show_queued": {
          "type": "boolean",
          "default": true,
          "description": "Show queued jobs"
        },
        "show_cancelled": {
          "type": "boolean",
          "default": false,
          "description": "Show cancelled jobs"
        },
        "job_type_filter": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[a-z_][a-z0-9_]*$"
          },
          "maxItems": 100,
          "description": "Filter by job types"
        },
        "relationship_filter": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["retry", "spawn", "fork", "callback", "compensation", "continuation", "batch_member", "dependency"]
          },
          "maxItems": 10,
          "description": "Filter by relationship types"
        },
        "time_range": {
          "type": "object",
          "properties": {
            "start": {
              "type": "string",
              "format": "date-time"
            },
            "end": {
              "type": "string",
              "format": "date-time"
            }
          },
          "additionalProperties": false,
          "description": "Time range filter"
        },
        "max_generation": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000,
          "description": "Maximum generation to show"
        }
      },
      "additionalProperties": false
    },
    "Error": {
      "type": "object",
      "title": "Error Response",
      "description": "Standard error response format",
      "properties": {
        "error": {
          "type": "string",
          "maxLength": 512,
          "description": "Error message"
        },
        "code": {
          "type": "string",
          "pattern": "^[A-Z_]+$",
          "description": "Error code"
        },
        "details": {
          "type": "object",
          "maxProperties": 20,
          "description": "Additional error details"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Error timestamp"
        },
        "request_id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9-]+$",
          "description": "Request identifier for tracing"
        },
        "path": {
          "type": "string",
          "maxLength": 256,
          "description": "API path where error occurred"
        }
      },
      "required": ["error", "code", "timestamp"],
      "additionalProperties": false
    },
    "PaginationInfo": {
      "type": "object",
      "title": "Pagination Information",
      "description": "Pagination metadata for paginated responses",
      "properties": {
        "limit": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10000,
          "description": "Items per page"
        },
        "offset": {
          "type": "integer",
          "minimum": 0,
          "description": "Items skipped"
        },
        "total": {
          "type": "integer",
          "minimum": 0,
          "description": "Total items available"
        },
        "has_more": {
          "type": "boolean",
          "description": "Whether more items are available"
        },
        "next_offset": {
          "type": "integer",
          "minimum": 0,
          "description": "Offset for next page"
        },
        "prev_offset": {
          "type": "integer",
          "minimum": 0,
          "description": "Offset for previous page"
        }
      },
      "required": ["limit", "offset", "total", "has_more"],
      "additionalProperties": false
    }
  }
}